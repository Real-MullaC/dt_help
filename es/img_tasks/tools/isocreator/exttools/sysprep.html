<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../../../img/favicon.ico" />
    <title>SysPrep Preparation Tool - DISMTools Help Documentation</title>
    <link rel="stylesheet" href="../../../../../css/theme.css" />
    <link rel="stylesheet" href="../../../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "SysPrep Preparation Tool";
        var mkdocs_page_input_path = "img_tasks/tools/isocreator/exttools/sysprep.es.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../../../index.html">
          <img src="../../../../../logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../../index.html">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/start.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../../getting_started/msmg_migration.html">MSMG Migration</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../../whats_new/highlights.html">What's new</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Image tasks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../img_tasks.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../online_inst_mgmt.html">Online installation management mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../offline_inst_mgmt.html">Offline installation management mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Image management</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/append_image.html">Appending to an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/apply_image.html">Applying an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/capture_image.html">Capturing an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/delete_image.html">Removing volume images from an image file</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/export_image.html">Exporting a Windows image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/list_image.html">Listing the contents of Windows images</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/mount_image.html">Mounting an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/remount_image.html">Remounting an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/split_image.html">Splitting an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../mgmt/unmount_image.html">Unmounting an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Image information dialogs</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../../info/infodlgs.html">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../info/img_info.html">Image file information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../info/pkg_info.html">Package information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../info/feat_info.html">Feature information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../info/appxpkg_info.html">AppX package information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../info/cap_info.html">Capability information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../info/drv_info.html">Driver information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../../info/winpe_info.html">Windows PE configuration information</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >OS packages</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../packages/pkgs.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../packages/add_package.html">Adding packages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../packages/remove_package.html">Removing packages</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Features</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../features/features.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../features/enable_feature.html">Enabling features</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../features/disable_feature.html">Disabling features</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >AppX packages</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../appx/appx.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../appx/add_provisionedappxpackage.html">Adding AppX packages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../appx/remove_provisionedappxpackage.html">Removing AppX packages</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Edition servicing</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../editions/editions.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../editions/set_edition.html">Upgrading an image to a higher edition</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../editions/set_productkey.html">Setting the product key</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Languages and regional servicing</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../langs/set_layereddriver.html">Setting keyboard layered drivers</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Capabilities</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../capabilities/caps.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../capabilities/add_capability.html">Adding capabilities</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../capabilities/remove_capability.html">Removing capabilities</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Drivers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../drivers/drvs.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../drivers/add_driver.html">Adding drivers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../drivers/export_driver.html">Exporting drivers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../drivers/import_driver.html">Importing drivers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../drivers/remove_driver.html">Removing drivers</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tools</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../mimgmgr.html">Mounted image manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../wim2esd.html">Image conversion</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../swm2wim.html">SWM file merger</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../configlisteditor.html">DISM Configuration List Editor</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >ISO creation tools</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../../isocreator.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../isocreate.html">Creating ISO files</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" >Installing the operating system</a>
    <ul class="current">
                <li class="toctree-l3"><a class="reference internal" href="../install/localinstall.html">Local installations</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Network-based installations</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../install/netinst/pxehelpers.html">Overview</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../install/netinst/setup.html">Creating a basic network setup (Hyper-V)</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../install/netinst/wds.html">Windows Deployment Services (WDS) Helper</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3 current"><a class="reference internal current" >External Tools</a>
    <ul class="current">
                <li class="toctree-l4"><a class="reference internal" href="dim.html">Driver Installation Module</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="dtpe_es.html">Extensibility Suite</a>
                </li>
                <li class="toctree-l4 current"><a class="reference internal current" href="#">SysPrep Preparation Tool</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Command-line</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="../cmdline/cmdline.html">Overview</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="../cmdline/scriptref.html">Administration Script Reference</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../regcpl.html">Image registry control panel</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../servicemgr.html">System service manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../envvarmgr.html">System environment variable manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Unattended answer files</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../unattend/unattend.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../unattend/unatt_man.html">Unattended answer file manager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../unattend/unatt_create.html">Unattended answer file creator</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../unattend/unatt_apply.html">Applying unattended answer files</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >External tools</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../exttools/themedesigner.html">Creating your themes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../exttools/dynaviewer.html">Viewing diagnostic logs</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">DISMTools Help Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Tools</li>
          <li class="breadcrumb-item">ISO creation tools</li>
          <li class="breadcrumb-item">Installing the operating system</li>
          <li class="breadcrumb-item">External Tools</li>
      <li class="breadcrumb-item active">SysPrep Preparation Tool</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="sysprep-preparation-tool">Sysprep Preparation Tool</h1>
<p>The Sysprep Preparation Tool is a utility included with DISMTools 0.7.1 and later versions that prepares a reference computer for Sysprep generalization. This is useful for system administrators who are not using Microsoft Configuration Manager, or a similar solution, and want a Windows image with preinstalled applications.</p>
<h2 id="usage">Usage</h2>
<h3 id="preparing-a-reference-computer-for-sysprep">Preparing a reference computer for Sysprep</h3>
<p>To use the Sysprep Preparation Tool, the computer must be in <strong>audit mode</strong>. To enter audit mode at the OOBE, press <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>F3</kbd>. The computer will restart and boot into audit mode automatically.</p>
<p><em>Do note that the installation must not be unattended. If it is, you will not be able to enter audit mode. If you had added an answer file, you'll need to remove it before installing the system. To remove answer files, go to Commands -&gt; Unattended answer files -&gt; Remove applied answer file.</em></p>
<p>You can determine if the OOBE is unattended in the reference computer by determining if you need to interact with it. For example, here:</p>
<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_InteractiveOOBE.png" />
</p>

<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_Reboot.png" />
</p>

<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_AuditMode.png" />
</p>

<p>If you see the above screen, you have successfully entered audit mode. Don't touch the Sysprep window as you don't need it for now. Either move it out of the way or close it.</p>
<p>Now, go ahead and install the applications you want to have preinstalled in your Windows image.</p>
<p><strong>Important notes when installing applications:</strong></p>
<ul>
<li>Try to avoid Microsoft Store applications as they cause Sysprep to fail. If a desktop application installs a Microsoft Store application (for example, to provide context menu integration with Windows 11), remove said application before running the tool<ul>
<li>In that similar vein, avoid using WinGet to install applications. The <code>winget</code> source is a Microsoft Store application</li>
</ul>
</li>
<li>Some applications, like Visual Studio Code, come in both user and machine-wide installation variants. Always use the machine-wide installation variant, if available</li>
</ul>
<h3 id="launching-the-sysprep-preparation-tool">Launching the Sysprep Preparation Tool</h3>
<p>The Sysprep Preparation Tool is automatically added to ISOs by the Preinstallation Environment Helper. To launch the tool, open the Autorun application (usually by double-clicking the ISO in the File Explorer, or by running <code>&lt;ISO letter&gt;:\autorun.exe</code>), and select <em>Prepare System for Image Capture</em>:</p>
<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_AutorunEntry.png" />
</p>

<p>In DISMTools 0.7.2 and later, you can pick from 2 modes in which the tool can run:</p>
<ul>
<li><strong>Automatic mode</strong> will run the tool with minimal user interaction and default settings. If a check fails or returns a warning, the tool will let you pause and review the results before proceeding</li>
<li><strong>Manual mode</strong> will run the tool with full user interaction</li>
</ul>
<p>Whichever mode you choose, you can also prepare the boot image of the installation media for image capture after Sysprep completes by checking <em>Capture image after preparing the system</em>. You can learn more about image capture in the <a href="../cmdline/scriptref.html">administration script reference</a>.</p>
<p>The guide will continue in manual mode.</p>
<p>You will arrive at the wizard.</p>
<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_Home.png" />
</p>

<p>The tool will perform checks on your computer before proceeding. These range from setup states, to third-party drivers, to domain join; and more. You will see the results of these checks after they complete:</p>
<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_CheckScreen.png" />
</p>

<p>To learn more about a check, click on its entry in the list:</p>
<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_CheckScreenDetails.png" />
</p>

<p>A check has 3 fields indicating status:</p>
<ul>
<li><strong>Compatible</strong>: Indicates whether the check passed or failed</li>
<li><strong>Details</strong>: Indicates what the check reported</li>
<li><strong>Severity</strong>: Indicates how severe possible issues can be. There are 3 levels of severity:<ul>
<li><strong>Information</strong>: The check is informational only. You will see an <em>Information</em> severity level if a check passes or if it didn't need to be run, or if it reported something but won't cause Sysprep to fail</li>
<li><strong>Warning</strong>: The check found a possible issue that may cause Sysprep to fail. You can choose to proceed past warnings, but it's not recommended</li>
<li><strong>Critical</strong>: The check found an issue that will cause Sysprep to fail. You cannot proceed past critical issues. With a critical severity level, a check automatically fails</li>
</ul>
</li>
</ul>
<p>It is important that none of the checks return a <em>Critical</em> severity level. Check details, when not informational, will often include steps that will help you resolve the issue.</p>
<p>Continuing with the wizard, you will arrive at this page, where you can configure options that will be passed to Sysprep:</p>
<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_AdvancedPrepSettings.png" />
</p>

<p>Normally, you don't need to configure anything here. The default options are suitable for most use cases. However, if you need to customize Sysprep's behavior, you can do so here.</p>
<p>Finally, wait for the tool to complete its work:</p>
<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_Preparation.png" />
</p>

<p align="center">
    <img src="../../../../res/img_tasks/tools/isocreator/syspreppreparator/SysprepPreparator_Finish.png" />
</p>

<p>After your computer shuts down, you can capture its image with your preferred method. If you want to make further modifications in an offline manner, boot into the DISMTools Preinstallation Environment and capture the entire drive to an image using the <strong>Image Capture</strong> Administration Script. <a href="../cmdline/scriptref.html">Refer to the Command-line Administration Script Reference for more information on this script</a>.</p>
<h2 id="related-content">Related content</h2>
<p>You can download this tool to run it independently here: <a href="https://github.com/CodingWonders/SysprepPreparator">Sysprep Preparator Repository</a>.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="dtpe_es.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../cmdline/cmdline.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../../../..";</script>
    <script src="../../../../../js/theme_extra.js"></script>
    <script src="../../../../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../../../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(false);
        });
    </script>

</body>
</html>
