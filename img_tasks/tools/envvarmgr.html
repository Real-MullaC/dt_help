<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>System environment variable manager - DISMTools Help Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "System environment variable manager";
        var mkdocs_page_input_path = "img_tasks/tools/envvarmgr.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../index.html">
          <img src="../../logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_started/start.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_started/msmg_migration.html">MSMG Migration</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../whats_new/highlights.html">What's new</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Image tasks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../img_tasks.html">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../online_inst_mgmt.html">Online installation management mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../offline_inst_mgmt.html">Offline installation management mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Image management</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/append_image.html">Appending to an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/apply_image.html">Applying an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/capture_image.html">Capturing an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/delete_image.html">Removing volume images from an image file</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/export_image.html">Exporting a Windows image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/list_image.html">Listing the contents of Windows images</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/mount_image.html">Mounting an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/remount_image.html">Remounting an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/split_image.html">Splitting an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../mgmt/unmount_image.html">Unmounting an image</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Image information dialogs</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../info/infodlgs.html">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../info/img_info.html">Image file information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../info/pkg_info.html">Package information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../info/feat_info.html">Feature information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../info/appxpkg_info.html">AppX package information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../info/cap_info.html">Capability information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../info/drv_info.html">Driver information</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../info/winpe_info.html">Windows PE configuration information</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >OS packages</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../packages/pkgs.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../packages/add_package.html">Adding packages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../packages/remove_package.html">Removing packages</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Features</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../features/features.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../features/enable_feature.html">Enabling features</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../features/disable_feature.html">Disabling features</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >AppX packages</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../appx/appx.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../appx/add_provisionedappxpackage.html">Adding AppX packages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../appx/remove_provisionedappxpackage.html">Removing AppX packages</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Edition servicing</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../editions/editions.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../editions/set_edition.html">Upgrading an image to a higher edition</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../editions/set_productkey.html">Setting the product key</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Languages and regional servicing</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../langs/set_layereddriver.html">Setting keyboard layered drivers</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Capabilities</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../capabilities/caps.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../capabilities/add_capability.html">Adding capabilities</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../capabilities/remove_capability.html">Removing capabilities</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Drivers</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../drivers/drvs.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../drivers/add_driver.html">Adding drivers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../drivers/export_driver.html">Exporting drivers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../drivers/import_driver.html">Importing drivers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../drivers/remove_driver.html">Removing drivers</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tools</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="mimgmgr.html">Mounted image manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="wim2esd.html">Image conversion</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="swm2wim.html">SWM file merger</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="configlisteditor.html">DISM Configuration List Editor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >ISO creation tools</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="isocreator.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="isocreator/isocreate.html">Creating ISO files</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Installing the operating system</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="isocreator/install/localinstall.html">Local installations</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Network-based installations</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="isocreator/install/netinst/pxehelpers.html">Overview</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="isocreator/install/netinst/setup.html">Creating a basic network setup (Hyper-V)</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="isocreator/install/netinst/wds.html">Windows Deployment Services (WDS) Helper</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >External Tools</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="isocreator/exttools/dim.html">Driver Installation Module</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="isocreator/exttools/dtpe_es.html">Extensibility Suite</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="isocreator/exttools/sysprep.html">SysPrep Preparation Tool</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l3"><a class="reference internal" >Command-line</a>
    <ul>
                <li class="toctree-l4"><a class="reference internal" href="isocreator/cmdline/cmdline.html">Overview</a>
                </li>
                <li class="toctree-l4"><a class="reference internal" href="isocreator/cmdline/scriptref.html">Administration Script Reference</a>
                </li>
    </ul>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="regcpl.html">Image registry control panel</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="servicemgr.html">System service manager</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">System environment variable manager</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#restoring-previous-variable-information">Restoring previous variable information</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Unattended answer files</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../unattend/unattend.html">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../unattend/unatt_man.html">Unattended answer file manager</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../unattend/unatt_create.html">Unattended answer file creator</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../unattend/unatt_apply.html">Applying unattended answer files</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >External tools</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../exttools/themedesigner.html">Creating your themes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../exttools/dynaviewer.html">Viewing diagnostic logs</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DISMTools Help Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html" class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Tools</li>
      <li class="breadcrumb-item active">System environment variable manager</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="system-environment-variable-manager">System Environment Variable Manager</h1>
<p>The System Environment Variable Manager lets you view and modify information about the environment variables in a Windows image. Use the Manager to view and/or modify environment names and values.</p>
<p align="center">
    <img src="../../res/img_tasks/tools/envvarmgr/envvarmgr.png" />
</p>

<p>You can access the Environment Variable Manager by going to <em>Tools -&gt; Manage system environment variables</em>.</p>
<p><em>This tool is available in DISMTools 0.7.1 and later.</em></p>
<p><strong>NOTE:</strong> when working with online installations, performing these steps will open the advanced system properties.</p>
<p>User variables will be applied to default user profiles.</p>
<h2 id="usage">Usage</h2>
<p>To modify variable information, select the variable from either the machine scope or user scope list. You can then modify the variable name and value. To save the updated variable, click <strong>Save Variable</strong>.</p>
<p>To save the list of variables to the target image, click <strong>Save</strong> on the bottom right.</p>
<p>You can also move and/or copy variables between the machine scope and user scope lists by using the <strong>Move to User Scope</strong>, <strong>Copy to User Scope</strong>, <strong>Move to Machine Scope</strong>, and <strong>Copy to Machine Scope</strong> buttons. These buttons are disabled when a variable is in both scopes (is hierarchical).</p>
<p>With hierarchical variables, the machine scope values are used first, then the user scope ones. Values in the machine scope may be overridden by user scope values, or prepended to them, when the user profile is loaded.</p>
<ul>
<li>For example, <code>PATH</code> values in machine and user scopes are combined</li>
</ul>
<p>Variables that contain references to additional environment variables in the system will be left unexpanded. The Manager, when saving the variables, will save such variables as expand string values in the registry. Otherwise, variables will be saved as string values.</p>
<p>To add or remove variables, click the <strong>Add user variable...</strong> or <strong>Add machine variable...</strong> buttons, or select a variable and click <strong>Remove user variable</strong> or <strong>Remove machine variable</strong>.</p>
<h2 id="restoring-previous-variable-information">Restoring previous variable information</h2>
<p>When saving variables, backups of both machine and user scope variables are saved to your desktop. To restore these backups:</p>
<ol>
<li>Use the Image Registry control panel to load the <code>SYSTEM</code> and <code>NTUSER.DAT</code> hives of the target image</li>
<li>Merge the <code>.reg</code> files in your desktop by double-clicking them</li>
<li>Unload the <code>SYSTEM</code> and <code>NTUSER.DAT</code> hives from the control panel and commit the changes</li>
</ol>
<p>While restoring the backup, you may see an error. This is normal, and many variables will be restored correctly despite the error. Of course, you can always look at the REG files themselves and use the service manager to restore the variables.</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="servicemgr.html" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../unattend/unattend.html" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(false);
        });
    </script>

</body>
</html>
